

<style>
  :host {
    --bright-blue: oklch(51.01% 0.274 263.83);
    --electric-violet: oklch(53.18% 0.28 296.97);
    --french-violet: oklch(47.66% 0.246 305.88);
    --vivid-pink: oklch(69.02% 0.277 332.77);
    --hot-red: oklch(61.42% 0.238 15.34);
    --orange-red: oklch(63.32% 0.24 31.68);

    --gray-900: oklch(19.37% 0.006 300.98);
    --gray-700: oklch(36.98% 0.014 302.71);
    --gray-400: oklch(70.9% 0.015 304.04);

    --red-to-pink-to-purple-vertical-gradient: linear-gradient(
      180deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --red-to-pink-to-purple-horizontal-gradient: linear-gradient(
      90deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --pill-accent: var(--bright-blue);

    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1 {
    font-size: 3.125rem;
    color: var(--gray-900);
    font-weight: 500;
    line-height: 100%;
    letter-spacing: -0.125rem;
    margin: 0;
    font-family: "Inter Tight", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
  }

  p {
    margin: 0;
    color: var(--gray-700);
  }

  main {
    width: 100%;
    min-height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    box-sizing: inherit;
    position: relative;
  }

  .angular-logo {
    max-width: 9.2rem;
  }

  .content {
    display: flex;
    justify-content: space-around;
    width: 100%;
    max-width: 700px;
    margin-bottom: 3rem;
  }

  .content h1 {
    margin-top: 1.75rem;
  }

  .content p {
    margin-top: 1.5rem;
  }

  .divider {
    width: 1px;
    background: var(--red-to-pink-to-purple-vertical-gradient);
    margin-inline: 0.5rem;
  }

  .pill-group {
    display: flex;
    flex-direction: column;
    align-items: start;
    flex-wrap: wrap;
    gap: 1.25rem;
  }

  .pill {
    display: flex;
    align-items: center;
    --pill-accent: var(--bright-blue);
    background: color-mix(in srgb, var(--pill-accent) 5%, transparent);
    color: var(--pill-accent);
    padding-inline: 0.75rem;
    padding-block: 0.375rem;
    border-radius: 2.75rem;
    border: 0;
    transition: background 0.3s ease;
    font-family: var(--inter-font);
    font-size: 0.875rem;
    font-style: normal;
    font-weight: 500;
    line-height: 1.4rem;
    letter-spacing: -0.00875rem;
    text-decoration: none;
  }

  .pill:hover {
    background: color-mix(in srgb, var(--pill-accent) 15%, transparent);
  }

  .pill-group .pill:nth-child(6n + 1) {
    --pill-accent: var(--bright-blue);
  }
  .pill-group .pill:nth-child(6n + 2) {
    --pill-accent: var(--french-violet);
  }
  .pill-group .pill:nth-child(6n + 3),
  .pill-group .pill:nth-child(6n + 4),
  .pill-group .pill:nth-child(6n + 5) {
    --pill-accent: var(--hot-red);
  }

  .pill-group svg {
    margin-inline-start: 0.25rem;
  }

  .social-links {
    display: flex;
    align-items: center;
    gap: 0.73rem;
    margin-top: 1.5rem;
  }

  .social-links path {
    transition: fill 0.3s ease;
    fill: var(--gray-400);
  }

  .social-links a:hover svg path {
    fill: var(--gray-900);
  }

  @media screen and (max-width: 650px) {
    .content {
      flex-direction: column;
      width: max-content;
    }

    .divider {
      height: 1px;
      width: 100%;
      background: var(--red-to-pink-to-purple-horizontal-gradient);
      margin-block: 1.5rem;
    }
  }
</style>

<div class="app-container">
  <!-- Header -->
  <mat-toolbar color="primary" class="header">
    <mat-icon>calculate</mat-icon>
    <span class="title">{{ title }}</span>
  </mat-toolbar>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Sidebar -->
    <mat-sidenav-container class="sidenav-container">
      <mat-sidenav mode="side" opened class="sidebar" [style.width.px]="350">

        <!-- Función -->
        <mat-card class="function-card">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>functions</mat-icon>
              Función
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="functionForm">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>f(x) =</mat-label>
                <input matInput formControlName="function" placeholder="x^2 - 4">
                <mat-hint>Ejemplo: x^2 - 4, sin(x), exp(x), x^3 + 2*x - 1</mat-hint>
              </mat-form-field>

              <div class="range-inputs">
                <mat-form-field appearance="outline">
                  <mat-label>X mínimo</mat-label>
                  <input matInput type="number" formControlName="xMin">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>X máximo</mat-label>
                  <input matInput type="number" formControlName="xMax">
                </mat-form-field>
              </div>
            </form>
          </mat-card-content>
        </mat-card>

        <!-- Métodos Numéricos -->
        <mat-card class="methods-card">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>science</mat-icon>
              Métodos Numéricos
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <mat-list>
              <mat-list-item *ngFor="let method of numericMethods"
                            [class.selected]="selectedMethod === method.id"
                            (click)="onMethodChange(method.id)"
                            class="method-item">
                <mat-icon matListItemIcon>calculate</mat-icon>
                <div matListItemTitle>{{ method.name }}</div>
                <div matListItemLine>{{ method.description }}</div>
              </mat-list-item>
            </mat-list>
          </mat-card-content>
        </mat-card>

        <!-- Parámetros del Método -->
        <mat-card class="parameters-card">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>settings</mat-icon>
              Parámetros
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="methodForm">
              <!-- Parámetros comunes -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Tolerancia</mat-label>
                <input matInput type="number" formControlName="tolerance" step="0.000001">
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Máximo de iteraciones</mat-label>
                <input matInput type="number" formControlName="maxIterations">
              </mat-form-field>

              <!-- Parámetros específicos para Newton-Raphson -->
              <mat-form-field appearance="outline" class="full-width" *ngIf="selectedMethod === 'newton'">
                <mat-label>Valor inicial (x₀)</mat-label>
                <input matInput type="number" formControlName="initialGuess">
              </mat-form-field>

              <!-- Parámetros para Simpson -->
              <div *ngIf="selectedMethod === 'simpson'">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Número de subintervalos (n)</mat-label>
                  <input matInput type="number" formControlName="n">
                </mat-form-field>

                <div class="interval-inputs">
                  <mat-form-field appearance="outline">
                    <mat-label>Límite inferior (a)</mat-label>
                    <input matInput type="number" formControlName="intervalA">
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <mat-label>Límite superior (b)</mat-label>
                    <input matInput type="number" formControlName="intervalB">
                  </mat-form-field>
                </div>
              </div>

              <!-- Parámetros para EDO -->
              <div *ngIf="selectedMethod === 'edo'">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Valor inicial x₀</mat-label>
                  <input matInput type="number" formControlName="initialGuess">
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Valor final x</mat-label>
                  <input matInput type="number" formControlName="finalX">
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Valor inicial y₀</mat-label>
                  <input matInput type="number" formControlName="initialY">
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Tamaño del paso (h)</mat-label>
                  <input matInput type="number" formControlName="stepSize" step="0.001">
                </mat-form-field>
              </div>

              <!-- Parámetros para Bisección -->
              <div class="interval-inputs" *ngIf="selectedMethod === 'bisection'">
                <mat-form-field appearance="outline">
                  <mat-label>Intervalo a</mat-label>
                  <input matInput type="number" formControlName="intervalA">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Intervalo b</mat-label>
                  <input matInput type="number" formControlName="intervalB">
                </mat-form-field>
              </div>
            </form>
          </mat-card-content>
        </mat-card>

        <!-- Botones de Acción -->
        <mat-card class="actions-card">
          <mat-card-content>
            <div class="action-buttons">
              <button mat-raised-button color="primary" (click)="calculate()" class="full-width">
                <mat-icon>play_arrow</mat-icon>
                Calcular
              </button>

              <button mat-stroked-button (click)="clearResults()" class="full-width">
                <mat-icon>clear</mat-icon>
                Limpiar
              </button>
            </div>
          </mat-card-content>
        </mat-card>

      </mat-sidenav>

      <!-- Main Content Area -->
      <mat-sidenav-content class="main-area">
        <div class="content-wrapper">

          <!-- Graph Area -->
          <div class="graph-container">
            <mat-card class="graph-card">
              <mat-card-header>
                <mat-card-title>
                  <mat-icon>show_chart</mat-icon>
                  Gráfico de la Función
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <div class="canvas-container">
                  <canvas #chartCanvas width="800" height="400"></canvas>
                </div>
              </mat-card-content>
            </mat-card>
          </div>

          <!-- Results Area -->
          <div class="results-container">
            <mat-card class="results-card">
              <mat-card-header>
                <mat-card-title>
                  <mat-icon>table_chart</mat-icon>
                  Resultados
                  <span class="method-name" *ngIf="selectedMethod">
                    ({{ getMethodName(selectedMethod) }})
                  </span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <div class="results-table" *ngIf="results.length > 0">
                  <table mat-table [dataSource]="results" class="full-width">
                    <!-- Iteración -->
                    <ng-container matColumnDef="iteration">
                      <th mat-header-cell *matHeaderCellDef>Iteración</th>
                      <td mat-cell *matCellDef="let result">{{ result.iteration }}</td>
                    </ng-container>

                    <!-- X -->
                    <ng-container matColumnDef="x">
                      <th mat-header-cell *matHeaderCellDef>
                        <span *ngIf="selectedMethod === 'newton'">x</span>
                        <span *ngIf="selectedMethod === 'simpson'">Integral</span>
                        <span *ngIf="selectedMethod === 'edo'">x</span>
                      </th>
                      <td mat-cell *matCellDef="let result">{{ result.x | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- f(x) -->
                    <ng-container matColumnDef="fx">
                      <th mat-header-cell *matHeaderCellDef>
                        <span *ngIf="selectedMethod === 'newton'">f(x)</span>
                        <span *ngIf="selectedMethod === 'simpson'">Error</span>
                        <span *ngIf="selectedMethod === 'edo'">y</span>
                      </th>
                      <td mat-cell *matCellDef="let result">{{ result.fx | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- f'(x) para Newton -->
                    <ng-container matColumnDef="fPrimeX" *ngIf="selectedMethod === 'newton'">
                      <th mat-header-cell *matHeaderCellDef>f'(x)</th>
                      <td mat-cell *matCellDef="let result">{{ result.fPrimeX | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- Error -->
                    <ng-container matColumnDef="error">
                      <th mat-header-cell *matHeaderCellDef>
                        <span *ngIf="selectedMethod === 'newton'">Error</span>
                        <span *ngIf="selectedMethod === 'simpson'">h</span>
                        <span *ngIf="selectedMethod === 'edo'">k₁</span>
                      </th>
                      <td mat-cell *matCellDef="let result">{{ result.error | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- k₂ para EDO -->
                    <ng-container matColumnDef="k2" *ngIf="selectedMethod === 'edo'">
                      <th mat-header-cell *matHeaderCellDef>k₂</th>
                      <td mat-cell *matCellDef="let result">{{ result.k2 | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- k₃ para EDO -->
                    <ng-container matColumnDef="k3" *ngIf="selectedMethod === 'edo'">
                      <th mat-header-cell *matHeaderCellDef>k₃</th>
                      <td mat-cell *matCellDef="let result">{{ result.k3 | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- k₄ para EDO -->
                    <ng-container matColumnDef="k4" *ngIf="selectedMethod === 'edo'">
                      <th mat-header-cell *matHeaderCellDef>k₄</th>
                      <td mat-cell *matCellDef="let result">{{ result.k4 | number:'1.6-6' }}</td>
                    </ng-container>

                    <!-- NMR para Newton-Raphson -->
                    <ng-container matColumnDef="nmr" *ngIf="selectedMethod === 'newton'">
                      <th mat-header-cell *matHeaderCellDef>NMR</th>
                      <td mat-cell *matCellDef="let result">{{ result.nmr | number:'1.6-6' }}</td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="getTableColumns()"></tr>
                    <tr mat-row *matRowDef="let row; columns: getTableColumns();"></tr>
                  </table>

                  <!-- Resumen de resultados -->
                  <div class="results-summary" *ngIf="results.length > 0">
                    <p><strong>Total de iteraciones:</strong> {{ results.length }}</p>
                    <p *ngIf="selectedMethod === 'newton'">
                      <strong>Raíz aproximada:</strong> {{ results[results.length - 1].x | number:'1.6-6' }}
                    </p>
                    <p *ngIf="selectedMethod === 'simpson'">
                      <strong>Valor de la integral:</strong> {{ results[0].x | number:'1.6-6' }}
                    </p>
                    <p *ngIf="selectedMethod === 'edo'">
                      <strong>Valor final y:</strong> {{ results[results.length - 1].fx | number:'1.6-6' }}
                    </p>
                  </div>
                </div>

                <div class="no-results" *ngIf="results.length === 0">
                  <mat-icon>info</mat-icon>
                  <p>Ingresa una función y selecciona un método para comenzar los cálculos.</p>
                </div>
              </mat-card-content>
            </mat-card>
          </div>

        </div>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>
</div>


<router-outlet />
